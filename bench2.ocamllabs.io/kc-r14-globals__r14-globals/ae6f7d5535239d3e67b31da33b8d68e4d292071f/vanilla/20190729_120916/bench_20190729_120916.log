opam init --bare --no-setup --no-opamrc  ./dependencies
[NOTE] Will configure from built-in defaults.
Checking for available remotes: rsync and local, git, mercurial.
  - you won't be able to use darcs repositories unless you install the darcs command on your system.


<><> Fetching repository information ><><><><><><><><><><><><><><><><><><><><><>
[default] Initialised
Linking to system dune files found at: /home/ctk21/.opam/4.07.1
/home/ctk21/.opam/4.07.1/bin/dune --version = 1.9.3
ln -s /home/ctk21/.opam/4.07.1/bin/dune /local/scratch/ctk21/back/20190726_/r14/ae6f7d5535239d3e67b31da33b8d68e4d292071f/sandmark/_opam/sys_dune/bin/dune
ln -s /home/ctk21/.opam/4.07.1/bin/jbuilder /local/scratch/ctk21/back/20190726_/r14/ae6f7d5535239d3e67b31da33b8d68e4d292071f/sandmark/_opam/sys_dune/bin/jbuilder
ln -s /home/ctk21/.opam/4.07.1/lib/dune /local/scratch/ctk21/back/20190726_/r14/ae6f7d5535239d3e67b31da33b8d68e4d292071f/sandmark/_opam/sys_dune/lib/dune
rm -rf dependencies/packages/ocaml/ocaml.4.10.0
rm -rf dependencies/packages/ocaml-base-compiler/ocaml-base-compiler.4.10.0
mkdir -p dependencies/packages/ocaml/ocaml.4.10.0
cp -R dependencies/template/ocaml/* dependencies/packages/ocaml/ocaml.4.10.0/
mkdir -p dependencies/packages/ocaml-base-compiler/ocaml-base-compiler.4.10.0
cp -R dependencies/template/ocaml-base-compiler/* \
  dependencies/packages/ocaml-base-compiler/ocaml-base-compiler.4.10.0/
{ url="$(cat ocaml-versions/4.10.0.comp)"; echo "url { src: \"$url\" }"; echo "setenv: [ [ ORUN_CONFIG_ocaml_url = \"$url\" ] ]"; } \
  >> dependencies/packages/ocaml-base-compiler/ocaml-base-compiler.4.10.0/opam
opam update

<><> Updating package repositories ><><><><><><><><><><><><><><><><><><><><><><>
[default] synchronised from file:///local/scratch/ctk21/back/20190726_/r14/ae6f7d5535239d3e67b31da33b8d68e4d292071f/sandmark/dependencies
Now run 'opam upgrade' to apply any package updates.
opam switch create --keep-build-dir --yes 4.10.0 ocaml-base-compiler.4.10.0

<><> Gathering sources ><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
[ocaml-base-compiler.4.10.0] downloaded from https://github.com/kayceesrk/ocaml/archive/ae6f7d5535239d3e67b31da33b8d68e4d292071f.tar.gz

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
∗ installed base-bigarray.base
∗ installed base-threads.base
∗ installed base-unix.base
[ERROR] The compilation of ocaml-base-compiler failed at "/local/scratch/ctk21/back/20190726_/r14/ae6f7d5535239d3e67b31da33b8d68e4d292071f/sandmark/_opam/opam-init/hooks/sandbox.sh build make -j 5 world".

#=== ERROR while compiling ocaml-base-compiler.4.10.0 =========================#
# context              2.0.4 | linux/x86_64 |  | file:///local/scratch/ctk21/back/20190726_/r14/ae6f7d5535239d3e67b31da33b8d68e4d292071f/sandmark/dependencies
# path                 /local/scratch/ctk21/back/20190726_/r14/ae6f7d5535239d3e67b31da33b8d68e4d292071f/sandmark/_opam/4.10.0/.opam-switch/build/ocaml-base-compiler.4.10.0
# command              /local/scratch/ctk21/back/20190726_/r14/ae6f7d5535239d3e67b31da33b8d68e4d292071f/sandmark/_opam/opam-init/hooks/sandbox.sh build make -j 5 world
# exit-code            2
# env-file             /local/scratch/ctk21/back/20190726_/r14/ae6f7d5535239d3e67b31da33b8d68e4d292071f/sandmark/_opam/log/ocaml-base-compiler-27894-d8a4ae.env
# output-file          /local/scratch/ctk21/back/20190726_/r14/ae6f7d5535239d3e67b31da33b8d68e4d292071f/sandmark/_opam/log/ocaml-base-compiler-27894-d8a4ae.out
### output ###
# [...]
# memprof.c: In function ‘caml_memprof_track_young’:
# memprof.c:434:56: error: ‘caml_young_ptr’ undeclared (first use in this function); did you mean ‘caml_context’?
#      mt_generate_binom(caml_memprof_young_trigger - 1 - caml_young_ptr) + 1;
#                                                         ^~~~~~~~~~~~~~
#                                                         caml_context
# memprof.c:434:56: note: each undeclared identifier is reported only once for each function it appears in
# Makefile:341: recipe for target 'memprof_b.o' failed
# make[1]: *** [memprof_b.o] Error 1
# make[1]: *** Waiting for unfinished jobs....
# make[1]: Leaving directory '/local/scratch/ctk21/back/20190726_/r14/ae6f7d5535239d3e67b31da33b8d68e4d292071f/sandmark/_opam/4.10.0/.opam-switch/build/ocaml-base-compiler.4.10.0/runtime'
# Makefile:351: recipe for target 'coldstart' failed
# make: *** [coldstart] Error 2



<><> Error report <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
┌─ The following actions failed
│ λ build ocaml-base-compiler 4.10.0
└─ 
┌─ The following changes have been performed (the rest was aborted)
│ ∗ install base-bigarray base
│ ∗ install base-threads  base
│ ∗ install base-unix     base
└─ 
Switch initialisation failed: clean up? ('n' will leave the switch partially installed) [Y/n] y
Makefile:64: recipe for target '_opam/4.10.0' failed
make: *** [_opam/4.10.0] Error 31
